{% extends "base.njk" %}

{% block content %}
<main>
  <header class="main-header">
    <div class="main-title">
      <h1>diaspora*</h1>
      <h2>Share what you want with whom you want</h2>
    </div>
    <div class="flex">
      <div class="col4">
        <div class="tile valign-wrapper">
          {{globalData.nodes}} <strong>Nodes</strong>
        </div>
      </div>
      <div class="col4">
        <div class="tile valign-wrapper">
          {{globalData.users}} <strong>Users</strong>
        </div>
      </div>
      <div class="col4">
        <div class="tile valign-wrapper">
          {{globalData.posts}} <strong>Posts</strong>
        </div>
      </div>
      <div class="col4">
        <div class="tile valign-wrapper">
          {{globalData.comments}} <strong>Comments</strong>
        </div>
      </div>
    </div>
  </header>
  <section class="tile">
    <header>
      <h2>What is diaspora*?</h2>
    </header>
    <div>
      <div class="flex">
        <div class="col2">
          <p>Presentation text</p>
          <div class="center">
            <a href="#" class="btn btn-primary">Visit network evolution</a>
          </div>
        </div>
        <div class="col2">
          <ul>
            <li>Nodes: <strong>{{globalData.nodes}}</strong></li>
            <li>Users: <strong>{{globalData.users}}</strong></li>
            <li>Last 6 months users: <strong>{{globalData.active_users_halfyear}}</strong></li>
            <li>Last month users: <strong>{{globalData.active_users_monthly}}</strong></li>
            <li>Posts: <strong>{{globalData.posts}}</strong></li>
            <li>Comments: <strong>{{globalData.comments}}</strong></li>
          </ul>
        </div>
      </div>
    </div>
  </section>
  <section class="tile">
    <header>
      <h2>Software version</h2>
    </header>
    <div>
      <p><strong>61%</strong> of the nodes hosting <strong>71%</strong> of the users are actually running the last released version or a development version.</p>
      <table>
        <thead>
            <tr>
                <th>Version</th>
                <th>Nodes</th>
                <th>Users</th>
            </tr>
        </thead>
        <tbody>
          <tr>
              <th>Develop</th>
              <td>12 (5%)</td>
              <td>1321 (6%)</td>
          </tr>
          <tr>
              <th>Last version</th>
              <td>142 (54%)</td>
              <td>123321 (65%)</td>
          </tr>
          <tr>
              <th>Last major version</th>
              <td>142 (32%)</td>
              <td>62324 (25%)</td>
          </tr>
          <tr>
              <th>Older</th>
              <td>142 (9%)</td>
              <td>3521 (7%)</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
  <section class="tile">
    <header>
      <h2>Software version</h2>
    </header>
    <div>
      <div id="chart-container" data-chart="{{chartData[0]}}"></div>
      <div class="flex">
        <div id="nodes-chart" class="btn-medium">Nodes</div>
        <div id="users-chart" class="btn-medium">Total users</div>
        <div id="last6months-chart" class="btn-medium">Last 6 months users</div>
        <div id="monthly-chart" class="btn-medium">Last month users</div>
        <div id="posts-chart" class="btn-medium">Posts</div>
        <div id="comments-chart" class="btn-medium">Comments</div>
      </div>
    </div>
  </section>
</main>

<script src="/vendor/js/rickshaw.min.js"></script>
<script src="/vendor/js/d3.v3.min.js"></script>
<link rel="stylesheet" href="/vendor/css/rickshaw.min.css">
<script src="/javascript/chart-helper.js"></script>
<script type="text/javascript">
  var nodesData = [{ x: 1990, y: 2 }, { x: 1995, y: 4 }, {x: 2000, y:3}];
  var usersData = [{ x: 0, y: 5 }, { x: 1, y: 8 }, {x: 2, y:12}];
  var chart = initChart(document.getElementById("chart-container"), nodesData);

  document.getElementById('nodes-chart').addEventListener('click', function() {
    refreshChart(chart, nodesData);
  });
  document.getElementById('users-chart').addEventListener('click', function() {
    refreshChart(chart, usersData);
  });
</script>
{% endblock content %}
